<!DOCTYPE html>
<html lang="ko">
<head>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-firestore-compat.js"></script>
    <script>
    // Firebase ÌîÑÎ°úÏ†ùÌä∏ ÏÑ§Ï†ï (Î≥∏Ïù∏ ÌîÑÎ°úÏ†ùÌä∏Î°ú ÍµêÏ≤¥!)    
    const firebaseConfig = {
      apiKey: "AIzaSyCv9qO_dTwSXTACNjrjQ5H13h09JzJwN9A",
      authDomain: "dailyroutine-ea1a1.firebaseapp.com",
      projectId: "dailyroutine-ea1a1",
      storageBucket: "dailyroutine-ea1a1.firebasestorage.app",
      messagingSenderId: "389292492309",
      appId: "1:389292492309:web:77dea07659d73391f3b01c",
      measurementId: "G-XQ2D0VB96G"
    };


    // Firebase Ï¥àÍ∏∞Ìôî
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÌÜµÌï© ÏùºÏùº Î£®Ìã¥ Í¥ÄÎ¶¨</title>
    <style>        
        * {
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f0f4f8;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .title {
            font-size: 28px;
            font-weight: bold;
            color: #1a365d;
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 16px;
            color: #4a5568;
            margin-bottom: 20px;
        }

        .date-info {
            font-size: 14px;
            color: #718096;
            font-style: italic;
        }

        .main-container {
            display: grid;
            grid-template-columns: 2fr 0.7fr;
            gap: 30px;
            max-width: 1400px;
            margin: 0 auto;
        }

        /* ÏôºÏ™Ω ÏòÅÏó≠ - Ï£ºÍ∞Ñ ÏóÖÎ¨¥ Ï≤¥ÌÅ¨Î¶¨Ïä§Ìä∏ */
        .weekly-tasks {
            background-color: white;
            border: 2px solid #1a365d;
            border-radius: 10px;
            padding: 10px;
        }

        .section-header {
            font-size: 20px;
            font-weight: bold;
            color: #1a365d;
            margin-bottom: 15px;
            text-align: center;
            padding-bottom: 10px;
            border-bottom: 2px solid #e2e8f0;
        }

        .week-selector {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .week-btn {
            padding: 8px 16px;
            border: 2px solid #1a365d;
            background-color: white;
            color: #1a365d;
            border-radius: 20px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            font-size: 12px;
        }

        .week-btn:hover {
            background-color: #e2e8f0;
            transform: translateY(-2px);
        }

        .week-btn.active {
            background-color: #1a365d;
            color: white;
        }

        .weekly-progress {
            text-align: center;
            margin-bottom: 20px;
            padding: 10px;
            background-color: #e2e8f0;
            border-radius: 5px;
            color: #1a365d;
            font-weight: bold;
            font-size: 16px;
        }

        .days-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
        }

        .day-card {
            background-color: #f7fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 10px;
            min-height: 200px;
        }

        .day-header {
            font-weight: bold;
            font-size: 14px;
            color: #1a365d;
            text-align: center;
            margin-bottom: 10px;
            padding-bottom: 5px;
            border-bottom: 1px solid #e2e8f0;
        }

        .day-card.today {
            border: 3px solid #4299e1;
            background-color: #ebf8ff;
        }

        .day-card.weekend {
            background-color: #fef5e7;
            border-color: #f6ad55;
        }

        .task-item {
            font-size: 11px;
            margin: 2px 0;
            padding: 2px 4px;
            border-radius: 3px;
            cursor: pointer;
            transition: all 0.2s;
            border-left: 3px solid #4299e1;
            background-color: #ebf8ff;
            color: #1a365d;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .task-item:hover {
            transform: scale(1.02);
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .task-item.completed {
            opacity: 0.7;
            text-decoration: line-through;
            background-color: #c6f6d5;
            border-left-color: #38a169;
        }

        .task-name {
            flex: 1;
        }

        .task-time {
            font-size: 8px;
            color: #666;
            margin-left: 4px;
            font-weight: normal;
        }

        .completion-counter {
            text-align: center;
            font-size: 10px;
            font-weight: bold;
            color: #1a365d;
            background-color: #e2e8f0;
            padding: 2px 5px;
            border-radius: 10px;
            margin-top: 5px;
        }

        .weekend-placeholder {
            text-align: center;
            font-size: 12px;
            color: #d69e2e;
            font-weight: bold;
            margin: 10px 0;
            padding: 10px;
            background-color: #fff8dc;
            border: 2px dashed #f6ad55;
            border-radius: 8px;
        }

        /* Ïò§Î•∏Ï™Ω ÏòÅÏó≠ - Ïö¥Îèô Î£®Ìã¥ */
        .exercise-area {
            background-color: white;
            border: 2px solid #2d5016;
            border-radius: 10px;
            padding: 10px;
        }

        .exercise-area .section-header {
            color: #2d5016;
            border-bottom-color: #e6f3e6;
        }

        .exercise-selector {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        .exercise-btn {
            padding: 8px 16px;
            border: 2px solid #2d5016;
            background-color: white;
            color: #2d5016;
            border-radius: 20px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            font-size: 12px;
        }

        .exercise-btn:hover {
            background-color: #e6f3e6;
        }

        .exercise-btn.active {
            background-color: #2d5016;
            color: white;
        }

        .routine-info {
            text-align: center;
            margin-bottom: 15px;
            padding: 8px;
            background-color: #e7f4fc;
            border-radius: 5px;
            color: #2d5016;
            font-weight: bold;
            font-size: 12px;
        }

        .routine-groups {
            display: grid;
            gap: 15px;
        }

        .routine-group {
            background-color: #f9f9f9;
            padding: 12px;
            border-radius: 8px;
        }

        .routine-group.warmup {
            border-left: 4px solid #3498db;
        }

        .routine-group.main {
            border-left: 4px solid #e74c3c;
        }

        .routine-group.cooldown {
            border-left: 4px solid #27ae60;
        }

        .routine-group.strength {
            border-left: 4px solid #e74c3c;
        }

        .routine-group.flexibility {
            border-left: 4px solid #3498db;
        }

        .routine-group.golf-basic {
            border-left: 4px solid #27ae60;
        }

        .routine-group h4 {
            margin: 0 0 10px 0;
            font-size: 14px;
            text-align: center;
            font-weight: bold;
        }

        .routine-group.warmup h4 { color: #3498db; }
        .routine-group.main h4 { color: #e74c3c; }
        .routine-group.cooldown h4 { color: #27ae60; }
        .routine-group.strength h4 { color: #e74c3c; }
        .routine-group.flexibility h4 { color: #3498db; }
        .routine-group.golf-basic h4 { color: #27ae60; }

        .routine-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .exercise-item {
            margin: 6px 0;
            padding: 8px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            border: 1px solid #ddd;
            text-align: center;
            font-size: 11px;
        }

        .exercise-name {
            font-weight: bold;
            margin-bottom: 2px;
        }

        .exercise-duration {
            font-size: 10px;
            color: #666;
            font-weight: normal;
        }

        .exercise-item.warmup { 
            background-color: #e7f4fc; 
            border-color: #3498db; 
        }
        .exercise-item.warmup .exercise-name { color: #3498db; }

        .exercise-item.main { 
            background-color: #fce7e7; 
            border-color: #e74c3c; 
        }
        .exercise-item.main .exercise-name { color: #e74c3c; }

        .exercise-item.cooldown { 
            background-color: #e8f9e8; 
            border-color: #27ae60; 
        }
        .exercise-item.cooldown .exercise-name { color: #27ae60; }

        .exercise-item.strength { 
            background-color: #fce7e7; 
            border-color: #e74c3c; 
        }
        .exercise-item.strength .exercise-name { color: #e74c3c; }

        .exercise-item.flexibility { 
            background-color: #e7f4fc; 
            border-color: #3498db; 
        }
        .exercise-item.flexibility .exercise-name { color: #3498db; }

        .exercise-item.golf-basic { 
            background-color: #e8f9e8; 
            border-color: #27ae60; 
        }
        .exercise-item.golf-basic .exercise-name { color: #27ae60; }

        .exercise-item.completed {
            opacity: 0.6;
            text-decoration: line-through;
            background-color: #f0f0f0;
            border-color: #ccc;
        }

        .exercise-item.completed .exercise-name,
        .exercise-item.completed .exercise-duration {
            color: #888;
        }

        .exercise-item:hover:not(.completed) {
            transform: translateY(-2px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        }

        @media (max-width: 1200px) {
            .main-container {
                grid-template-columns: 1fr;
                gap: 20px;
            }
        }

        @media (max-width: 768px) {
            .days-grid {
                grid-template-columns: 1fr;
            }
            
            .day-card {
                min-height: 150px;
            }
            
            .week-btn, .exercise-btn {
                padding: 6px 12px;
                font-size: 11px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="date-info" style="font-size:9px; text-align:right;">Last update 2026.1.19 ver.07</div>
        <div class="title">üóìÔ∏è ÌÜµÌï© ÏùºÏùº Î£®Ìã¥ Í¥ÄÎ¶¨</div>
        <div class="subtitle">Íæ∏Ï§ÄÌïú ÏùºÏÉÅ Í¥ÄÎ¶¨ÏôÄ Ïö¥ÎèôÏúºÎ°ú ÏÑ±Ïû•ÌïòÎäî Îß§ÏùºÏùÑ ÎßåÎì§Ïñ¥Î≥¥ÏÑ∏Ïöî!</div>        
        <div class="date-info" id="dateInfo"></div>        
        <div id="authContainer" style="max-width:400px; margin:5px auto; padding:5px; border-radius:3px; text-align:center;">        
        <form id="authForm">
            <input type="email" id="email" placeholder="Ïù¥Î©îÏùº" required 
                style="width:100%; padding:10px; margin:8px 0; border:1px solid #ccc; border-radius:6px; font-size:10px;">
            <input type="password" id="password" placeholder="ÎπÑÎ∞ÄÎ≤àÌò∏ (6Ïûê Ïù¥ÏÉÅ)" required minlength="6"
                style="width:100%; padding:10px; margin:8px 0; border:1px solid #ccc; border-radius:6px; font-size:10px;">
            
            <div style="display:flex; gap:10px; margin-top:5px;">
            <button type="submit" id="loginBtn" 
                    style="flex:1; padding:12px; background:#1a365d; color:white; border:none; border-radius:6px; cursor:pointer; font-weight:bold;">
                Î°úÍ∑∏Ïù∏
            </button>
            <button type="button" id="signupBtn" 
                    style="flex:1; padding:12px; background:#2d5016; color:white; border:none; border-radius:6px; cursor:pointer; font-weight:bold;">
                ÌöåÏõêÍ∞ÄÏûÖ
            </button>
            </div>
        </form>

        <div id="authMessage" style="margin-top:5px; color:#e74c3c; font-size:10px;"></div>
        <div id="userInfo" style="margin-top:5px; display:none; align-items:center; justify-content:center; gap:10px;">
            <img id="userPhoto" width="40" style="border-radius:50%;">
            <span id="userName" style="font-weight:normal; font-size:10px;"></span>
            <button id="logoutBtn" style="padding:6px 10px; font-size:10px; background:#e74c3c; color:white; border:none; border-radius:4px; cursor:pointer;">
            Î°úÍ∑∏ÏïÑÏõÉ
            </button>
        </div>
    </div>      

    <div class="main-container">
        <div class="weekly-tasks">
            <div class="section-header">üìã Ï£ºÍ∞Ñ ÏóÖÎ¨¥ Ï≤¥ÌÅ¨Î¶¨Ïä§Ìä∏</div>
            
            <div class="week-selector" id="weekSelector">
                </div>
            
            <div class="weekly-progress" id="weeklyProgress">
                </div>
            
            <div class="days-grid" id="daysGrid">
                </div>
        </div>

        <div class="exercise-area">
            <div class="section-header">üèÉ‚Äç‚ôÇÔ∏è My Task </div>
            
            <div class="exercise-selector">
                <button class="exercise-btn active" onclick="selectExercise('swimming')" id="swimmingBtn">‚õ≥ Daily Tasks</button>
                <button class="exercise-btn" onclick="selectExercise('golf')" id="golfBtn">üèä‚Äç‚ôÇÔ∏è WORKOUT</button>
            </div>
            
            <div class="routine-info" id="routineInfo">
                </div>
            
            <div class="routine-groups" id="routineGroups">
                </div>
        </div>
    </div>
    
    <script>
        // Ï†ÑÏó≠ Î≥ÄÏàò
        let currentUser = null;
        let unsubscribeTasks = null;
        let unsubscribeExercise = null;

        const tasks = [ /* Í∏∞Ï°¥ tasks Î∞∞Ïó¥ Í∑∏ÎåÄÎ°ú */ 
            { name: "Pills&Coffee", type: "health" },                                   
            { name: "Go to Work", type: "health" },
            { name: "Email|Plan", type: "business" },
            { name: "Modelica", type: "study" },   
            { name: "CycleBook", type: "study" }, 
            { name: "Lunch&Rest", type: "health" },
            { name: "Report1", type: "business" },   
            { name: "Report2", type: "business" },  
            { name: "Report3", type: "business" },
            { name: "Training1", type: "study" },                   
            { name: "Training2", type: "study" },
            { name: "Dinner|Go home", type: "health" }            
        ];

        const startDate = new Date(2026, 0, 18);
        let currentWeek = 1;
        let currentExercise = 'swimming';

        
        const swimmingDatabase = {
            warmup: [
                { name: "Îß§Ïùº 5Î∂Ñ Ïä§Ìä∏Î†àÏπ≠", duration: "5Î∂Ñ", link: "https://www.youtube.com/watch?v=WdT4wzneh24&list=PLhkZVYEI4DwM2ugZbGpXo1QyyoAkDKXYn&index=1", emoji: "ü§∏‚Äç‚ôÇÔ∏è" },
                { name: "ÏÑúÏÑúÌïòÎäî Ïä§Ìä∏Î†àÏπ≠", duration: "8Î∂Ñ", link: "https://www.youtube.com/watch?v=YQ8ZDRQPsKI&list=PLhkZVYEI4DwM2ugZbGpXo1QyyoAkDKXYn&index=2", emoji: "ü¶µ" },
                { name: "Í∞ÑÎã®Ìïú ÏöîÍ∞Ä ÎèôÏûë", duration: "10Î∂Ñ", link: "https://www.youtube.com/watch?v=El7yTMfqkzs&list=PLhkZVYEI4DwM2ugZbGpXo1QyyoAkDKXYn&index=3", emoji: "üåÄ" },
                { name: "10Î∂Ñ Ï†ÑÏã† Ïä§Ìä∏Î†àÏπ≠", duration: "13Î∂Ñ", link: "https://www.youtube.com/watch?v=kB0_xQdt2ow&list=PLhkZVYEI4DwM2ugZbGpXo1QyyoAkDKXYn&index=4", emoji: "üôÜ‚Äç‚ôÇÔ∏è" }
            ],
            main: [
                { name: "ÏûêÏú†Ìòï Ïù¥ÎØ∏ÏßÄ Ìä∏Î†àÏù¥Îãù", duration: "2Î∂Ñ", link: "https://www.youtube.com/watch?v=pP7ZI0pLc2A&list=PLhkZVYEI4DwOzDtwQ3BYgJsvR3-JHyjXj&index=11", emoji: "üèä‚Äç‚ôÇÔ∏è" },
                { name: "ÌèâÏòÅ Ïù¥ÎØ∏ÏßÄ Ìä∏Î†àÏù¥Îãù", duration: "2Î∂Ñ", link: "https://www.youtube.com/watch?v=n030qdOt6Zo&list=PLhkZVYEI4DwOzDtwQ3BYgJsvR3-JHyjXj&index=19", emoji: "üê∏" },
                { name: "Î∞∞ÏòÅ Ïù¥ÎØ∏ÏßÄ Ìä∏Î†àÏù¥Îãù", duration: "2Î∂Ñ", link: "https://www.youtube.com/watch?v=VaLg-SKvfDg&list=PLhkZVYEI4DwOzDtwQ3BYgJsvR3-JHyjXj&index=20", emoji: "üèä‚Äç‚ôÄÔ∏è" },
                { name: "ÏûêÏú†Ìòï ÌÇ• ÎìúÎ¶¥ Ïó∞Ïäµ", duration: "3Î∂Ñ", link: "https://www.youtube.com/watch?v=vH9Ig05MlrM&t=0m47s", emoji: "ü¶µ" },
                { name: "ÏûêÏú†Ìòï Ïä§ÌîºÎìú ÎìúÎ¶¥", duration: "2Î∂Ñ", link: "https://www.youtube.com/watch?v=vH9Ig05MlrM&t=1m22s", emoji: "‚ö°" },
                { name: "Ï†ëÏòÅ Ïù¥ÎØ∏ÏßÄ Ìä∏Î†àÏù¥Îãù", duration: "2Î∂Ñ 30Ï¥à", link: "https://www.youtube.com/watch?v=zyWs0LbkoRc&list=PLhkZVYEI4DwOzDtwQ3BYgJsvR3-JHyjXj&index=33", emoji: "ü¶ã" },
                { name: "ÌîåÎ¶ΩÌÑ¥ Ïù¥ÎØ∏ÏßÄ Ìä∏Î†àÏù¥Îãù", duration: "2Î∂Ñ", link: "https://www.youtube.com/watch?v=wfhCP7Xkej8&list=PLhkZVYEI4DwOzDtwQ3BYgJsvR3-JHyjXj&index=38", emoji: "üîÑ" },
                { name: "TheraBand Ïñ¥Íπ® Í∞ïÌôî", duration: "3Î∂Ñ", link: "https://www.youtube.com/watch?v=W8bV-kse8fw&t=5m24s", emoji: "üí™" }
            ],
            cooldown: [
                { name: "5Î∂Ñ Ìò∏Ìù°Î™ÖÏÉÅ", duration: "7Î∂Ñ", link: "https://www.youtube.com/watch?v=dZewQEbQQM0&list=PLhkZVYEI4DwPhxwTaOhwf2Tmu-ZLa187U", emoji: "üßò‚Äç‚ôÇÔ∏è" },
                { name: "5Î∂Ñ Î™ÖÏÉÅ", duration: "8Î∂Ñ", link: "https://www.youtube.com/watch?v=6Qu5E3MrVH8&list=PLhkZVYEI4DwPhxwTaOhwf2Tmu-ZLa187U&index=2", emoji: "üßò‚Äç‚ôÇÔ∏è" },
                { name: "5Î∂Ñ ÏïÑÏπ®Î™ÖÏÉÅ", duration: "5Î∂Ñ", link: "https://www.youtube.com/watch?v=quQoNETX3s8&list=PLhkZVYEI4DwPhxwTaOhwf2Tmu-ZLa187U&index=3", emoji: "üßò‚Äç‚ôÇÔ∏è" },
                { name: "5Î∂Ñ Ìò∏Ìù°Î™ÖÏÉÅ", duration: "7Î∂Ñ", link: "https://www.youtube.com/watch?v=VwERiv2CxRI&list=PLhkZVYEI4DwPhxwTaOhwf2Tmu-ZLa187U&index=4", emoji: "üßò‚Äç‚ôÇÔ∏è" },
                { name: "ÎπºÍ∏∞ Î™ÖÏÉÅ", duration: "5Î∂Ñ", link: "https://www.youtube.com/watch?v=LaM3-_ntnjU&list=PLhkZVYEI4DwPhxwTaOhwf2Tmu-ZLa187U&index=5", emoji: "üßò‚Äç‚ôÇÔ∏è" }
            ]
        };

        const golfDatabase = [
            {
                weekDay: 0,
                name: "Ìú¥ÏãùÏùº",
                items: [
                    { name: "Í∞ÄÎ≤ºÏö¥ ÏÇ∞Ï±Ö", reps: "40-60Î∂Ñ", type: "flexibility" },
                    { name: "Ïñ¥Î∞ò Ïä§ÏºÄÏπò", reps: "40-60Î∂Ñ", type: "flexibility" },
                    { name: "ÏòÅÌôî Î≥¥Í∏∞", reps: "90-150Î∂Ñ", type: "flexibility" }
                ]
            },
            {
                weekDay: [2, 4, 6],
                name: "Í∏∞Î≥∏ Í∑ºÎ†•Î†• Ïö¥Îèô Î£®Ìã¥",
                items: [
                    { name: "ÌîåÎû≠ÌÅ¨", reps: "30Ï¥à√ó3ÏÑ∏Ìä∏", type: "strength", link: "https://www.youtube.com/shorts/UBErzTq0Xcs" },
                    { name: "Ïä§ÏøºÌä∏", reps: "15Ìöå√ó3ÏÑ∏Ìä∏", type: "strength", link: "https://www.youtube.com/shorts/WjLvyBtRX_I" },
                    { name: "Îü∞ÏßÄ", reps: "Í∞Å12Ìöåx3ÏÑ∏Ìä∏", type: "strength", link: "https://www.youtube.com/shorts/lO8B4wEFt4k" },
                    { name: "Ìë∏ÏãúÏóÖ", reps: "10Ìöåx3ÏÑ∏Ìä∏", type: "strength", link: "https://m.youtube.com/shorts/kzxjsK_i2EE" },
                    { name: "ÌûôÎ∏åÎ¶øÏßÄ", reps: "15Ìöå√ó3ÏÑ∏Ìä∏", type: "strength", link: "https://www.youtube.com/shorts/lyp7w3wE3FA" },
                    { name: "Î≤ÑÎìúÎèÖ", reps: "10Ìöåx3ÏÑ∏Ìä∏", type: "strength", link: "https://m.youtube.com/shorts/nR3gnkcx1fg" },                    
                    { name: "ÏïÑÍ∏∞ ÏûêÏÑ∏", reps: "40Ï¥àx2ÏÑ∏Ìä∏", type: "flexibility", link: "https://www.youtube.com/shorts/D2JRyK413LE" },
                    { name: "ÌñÑÏä§Ìä∏ÎßÅ Ïä§Ìä∏Î†àÏπ≠", reps: "Í∞Å30Ï¥àx2ÏÑ∏Ìä∏", type: "flexibility", link: "https://www.youtube.com/shorts/Oaz_PeM6Now" },
                    { name: "ÏóâÎç©Ïù¥ Ïä§Ìä∏Î†àÏπ≠", reps: "Í∞Å30Ï¥àx2ÏÑ∏", type: "flexibility", link: "https://www.youtube.com/shorts/zICrR1-sFis" },
                    { name: "Í≥®ÌîÑ Î†àÏä® 1", reps: "10Ï¥à~10Î∂Ñ", type: "golf-basic", link: "https://www.youtube.com/watch?v=JzgT-m6u5tc&list=PLhkZVYEI4DwPNE7wERRGnSKgSYzFNee53&index=1" },     
                    { name: "Í≥®ÌîÑ Î†àÏä® 2", reps: "10Ï¥à~10Î∂Ñ", type: "golf-basic", link: "https://www.youtube.com/watch?v=a8xdxzSjCaU&list=PLhkZVYEI4DwPNE7wERRGnSKgSYzFNee53&index=4" },     
                    { name: "Í≥®ÌîÑ Î†àÏä® 3", reps: "10Ï¥à~10Î∂Ñ", type: "golf-basic", link: "https://www.youtube.com/watch?v=L8XKMOQaQQg&list=PLhkZVYEI4DwPNE7wERRGnSKgSYzFNee53&index=7" },   
                    { name: "Í≥®ÌîÑ Î†àÏä® 4", reps: "10Ï¥à~10Î∂Ñ", type: "golf-basic", link: "https://www.youtube.com/watch?v=PUn9hi5yJKU&list=PLhkZVYEI4DwPNE7wERRGnSKgSYzFNee53&index=11" },
                    { name: "Í≥®ÌîÑ Î†àÏä® 5", reps: "10Ï¥à~10Î∂Ñ", type: "golf-basic", link: "https://www.youtube.com/watch?v=xPiTWUhTaA0&list=PLhkZVYEI4DwPNE7wERRGnSKgSYzFNee53&index=15" }
                ]
            },
            {
                weekDay: [1, 3, 5],
                name: "Ïä§Ìä∏Î†àÏπ≠ Ïö¥Îèô Î£®Ìã¥",
                items: [     
                    { name: "ÌûôÎ∏åÎ¶øÏßÄ", reps: "15Ìöå√ó3ÏÑ∏Ìä∏", type: "strength", link: "https://www.youtube.com/shorts/lyp7w3wE3FA" },
                    { name: "Î≤ÑÎìúÎèÖ", reps: "10Ìöåx3ÏÑ∏Ìä∏", type: "strength", link: "https://m.youtube.com/shorts/nR3gnkcx1fg" },
                    { name: "Îü∞ÏßÄ", reps: "Í∞Å12Ìöåx3ÏÑ∏Ìä∏", type: "strength", link: "https://www.youtube.com/shorts/lO8B4wEFt4k" },
                    { name: "Í≥†ÏñëÏù¥-ÏÜå ÏûêÏÑ∏", reps: "10Ìöåx2ÏÑ∏Ìä∏", type: "flexibility", link: "https://www.youtube.com/shorts/ZfeUIoX2WVg" },
                    { name: "Í≥†Í¥ÄÏ†à Ïä§Ìä∏Î†àÏπ≠", reps: "Í∞Å30Ï¥àx2ÏÑ∏Ìä∏", type: "flexibility", link: "https://www.youtube.com/shorts/Epz5t2sUIus" },
                    { name: "ÌùâÏ∂î ÌöåÏ†Ñ Ïä§Ìä∏Î†àÏπ≠", reps: "Í∞Å10Ìöåx2ÏÑ∏Ìä∏", type: "flexibility", link: "https://www.youtube.com/watch?v=nKMQMj6o1vo" },
                    { name: "Î≤Ω Ïä§Ìä∏Î†àÏπ≠", reps: "Í∞Å30Ï¥àx2ÏÑ∏Ìä∏", type: "flexibility", link: "https://m.youtube.com/shorts/JKGDc6BguPc" },
                    { name: "ÏïÑÍ∏∞ ÏûêÏÑ∏", reps: "40Ï¥àx2ÏÑ∏Ìä∏", type: "flexibility", link: "https://www.youtube.com/shorts/D2JRyK413LE" },
                    { name: "ÌñÑÏä§Ìä∏ÎßÅ Ïä§Ìä∏Î†àÏπ≠", reps: "Í∞Å30Ï¥àx2ÏÑ∏Ìä∏", type: "flexibility", link: "https://www.youtube.com/shorts/Oaz_PeM6Now" },
                    { name: "Ïù¥ÏÉÅÍ∑º Ïä§Ìä∏Î†àÏπ≠", reps: "Í∞Å30Ï¥àx2ÏÑ∏", type: "flexibility", link: "https://www.youtube.com/watch?v=XTX6qOoIAXA" },
                    { name: "Í≥®ÌîÑ Î†àÏä®", reps: "10Ï¥à~10Î∂Ñ", type: "golf-basic", link: "https://www.youtube.com/watch?v=xPiTWUhTaA0&list=PLhkZVYEI4DwPNE7wERRGnSKgSYzFNee53&index=15" },
                    { name: "Í≥®ÌîÑ Î†àÏä® 1", reps: "10Ï¥à~10Î∂Ñ", type: "golf-basic", link: "https://www.youtube.com/watch?v=ACQh138gJeo&list=PLhkZVYEI4DwPNE7wERRGnSKgSYzFNee53&index=19" },     
                    { name: "Í≥®ÌîÑ Î†àÏä® 2", reps: "10Ï¥à~10Î∂Ñ", type: "golf-basic", link: "https://www.youtube.com/watch?v=LlPJD-T2bFM&list=PLhkZVYEI4DwPNE7wERRGnSKgSYzFNee53&index=23" },     
                    { name: "ÎìúÎùºÏù¥Î≤Ñ Î†àÏä®", reps: "14Î∂Ñ", type: "golf-basic", link: "https://www.youtube.com/watch?v=7huvGFnP0Xc" },   
                    { name: "ÏïÑÏù¥Ïñ∏ Î†àÏä®", reps: "11Î∂Ñ", type: "golf-basic", link: "https://www.youtube.com/watch?v=SYZoT4pO5-0&t=32s" },
                    { name: "Ïä§Ïúô Î†à", reps: "10Î∂Ñ", type: "golf-basic", link: "https://www.youtube.com/watch?v=4wirbEkrJ10" }
                    
                ]            
            }
        ];

        // === UI ÏöîÏÜå ===
        const authForm = document.getElementById('authForm');
        const emailInput = document.getElementById('email');
        const passwordInput = document.getElementById('password');
        const loginBtn = document.getElementById('loginBtn');
        const signupBtn = document.getElementById('signupBtn');
        const authMessage = document.getElementById('authMessage');
        const userInfo = document.getElementById('userInfo');
        const userName = document.getElementById('userName');
        const logoutBtn = document.getElementById('logoutBtn');

        // === Ïù∏Ï¶ù ÏÉÅÌÉú Í∞êÏãú ===
        firebase.auth().onAuthStateChanged(user => {
            if (user) {
            currentUser = user;
            document.getElementById('authContainer').querySelector('form').style.display = 'none';
            userInfo.style.display = 'flex';
            userName.textContent = user.email;
            loadUserData();
            } else {
            currentUser = null;
            document.getElementById('authContainer').querySelector('form').style.display = 'block';
            userInfo.style.display = 'none';
            clearAllData();
            }
        });

        // === Î°úÍ∑∏Ïù∏ ===
        loginBtn.onclick = async (e) => {
            e.preventDefault();
            const email = emailInput.value.trim();
            const password = passwordInput.value;
            if (!email || !password) return showMessage('Ïù¥Î©îÏùºÍ≥º ÎπÑÎ∞ÄÎ≤àÌò∏Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî.');

            try {
            await firebase.auth().signInWithEmailAndPassword(email, password);
            showMessage('Î°úÍ∑∏Ïù∏ ÏÑ±Í≥µ!', 'success');
            } catch (error) {
            showMessage(getErrorMessage(error.code));
            }
        };

        // === ÌöåÏõêÍ∞ÄÏûÖ ===
        signupBtn.onclick = async () => {
            const email = emailInput.value.trim();
            const password = passwordInput.value;
            if (!email || !password) return showMessage('Ïù¥Î©îÏùºÍ≥º ÎπÑÎ∞ÄÎ≤àÌò∏Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî.');

            try {
            await firebase.auth().createUserWithEmailAndPassword(email, password);
            showMessage('ÌöåÏõêÍ∞ÄÏûÖ ÏÑ±Í≥µ! Î°úÍ∑∏Ïù∏ÎêòÏóàÏäµÎãàÎã§.', 'success');
            } catch (error) {
            showMessage(getErrorMessage(error.code));
            }
        };

        // === Î°úÍ∑∏ÏïÑÏõÉ ===
        logoutBtn.onclick = () => {
            firebase.auth().signOut();
        };

        // === ÏóêÎü¨ Î©îÏãúÏßÄ ÌïúÍ∏ÄÌôî ===
        function getErrorMessage(code) {
            const messages = {
            'auth/user-not-found': 'Í∞ÄÏûÖÎêòÏßÄ ÏïäÏùÄ Ïù¥Î©îÏùºÏûÖÎãàÎã§.',
            'auth/wrong-password': 'ÎπÑÎ∞ÄÎ≤àÌò∏Í∞Ä ÌãÄÎ†∏ÏäµÎãàÎã§.',
            'auth/email-already-in-use': 'Ïù¥ÎØ∏ ÏÇ¨Ïö© Ï§ëÏù∏ Ïù¥Î©îÏùºÏûÖÎãàÎã§.',
            'auth/weak-password': 'ÎπÑÎ∞ÄÎ≤àÌò∏Îäî 6Ïûê Ïù¥ÏÉÅÏù¥Ïñ¥Ïïº Ìï©ÎãàÎã§.',
            'auth/invalid-email': 'Ïú†Ìö®ÌïòÏßÄ ÏïäÏùÄ Ïù¥Î©îÏùº ÌòïÏãùÏûÖÎãàÎã§.',
            'auth/too-many-requests': 'ÎÑàÎ¨¥ ÎßéÏùÄ ÏãúÎèÑ. Ïû†Ïãú ÌõÑ Îã§Ïãú ÏãúÎèÑÌïòÏÑ∏Ïöî.'
            };
            return messages[code] || 'Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.';
        }

        function showMessage(msg, type = 'error') {
            authMessage.textContent = msg;
            authMessage.style.color = type === 'success' ? '#27ae60' : '#e74c3c';
            setTimeout(() => authMessage.textContent = '', 3000);
        }

        // === Firestore Îç∞Ïù¥ÌÑ∞ Î°úÎìú ===
        function loadUserData() {
            if (!currentUser) return;

            const userRef = db.collection('users').doc(currentUser.uid);

            if (unsubscribeTasks) unsubscribeTasks();
            unsubscribeTasks = userRef.collection('weeklyTasks').onSnapshot(snapshot => {
            taskProgress = {};
            snapshot.forEach(doc => { taskProgress[doc.id] = doc.data(); });
            updateWeekView();
            }, err => console.error('ÌÉúÏä§ÌÅ¨ Î°úÎìú Ïò§Î•ò:', err));

            if (unsubscribeExercise) unsubscribeExercise();
            unsubscribeExercise = userRef.collection('exerciseProgress').onSnapshot(snapshot => {
            exerciseProgress = {};
            snapshot.forEach(doc => { exerciseProgress[doc.id] = doc.data(); });
            updateExerciseView();
            }, err => console.error('Ïö¥Îèô Î°úÎìú Ïò§Î•ò:', err));
        }

        // === Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû• ===
        async function saveTaskProgress(taskId, data) {
            if (!currentUser) return;
            try {
            await db.collection('users').doc(currentUser.uid)
                    .collection('weeklyTasks').doc(taskId).set(data, { merge: true });
            } catch (err) {
            console.error('ÌÉúÏä§ÌÅ¨ Ï†ÄÏû• Ïã§Ìå®:', err);
            }
        }

        async function saveExerciseProgress(dateKey, index, completed) {
            if (!currentUser) return;
            const docRef = db.collection('users').doc(currentUser.uid)
                            .collection('exerciseProgress').doc(dateKey);
            try {
            if (completed) {
                await docRef.set({ [index]: true }, { merge: true });
            } else {
                const doc = await docRef.get();
                if (doc.exists && doc.data()[index] !== undefined) {
                await docRef.update({ [index]: firebase.firestore.FieldValue.delete() });
                }
            }
            } catch (err) {
            console.error('Ïö¥Îèô Ï†ÄÏû• Ïã§Ìå®:', err);
            }
        }

        // === Í∏∞Ï°¥ Ìï®ÏàòÎì§ (Firestore Í∏∞Î∞ò) ===
        let taskProgress = {};
        let exerciseProgress = {};

        function getWeekNumber(date) {
            const diffTime = date.getTime() - startDate.getTime();
            const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
            return Math.floor(diffDays / 7) + 1;
        }

        function createWeekSelector() {
            const selector = document.getElementById('weekSelector');
            const today = new Date();
            const currentWeekNum = getWeekNumber(today);
            
            for (let week = 1; week <= 20; week++) {
            const btn = document.createElement('button');
            btn.className = 'week-btn';
            btn.textContent = `W${week}`;
            btn.dataset.week = week;
            btn.onclick = () => selectWeek(week);
            if (week === currentWeekNum) {
                btn.classList.add('active');
                currentWeek = week;
            }
            selector.appendChild(btn);
            }            
        }

        function selectWeek(week) {
            currentWeek = week;
            document.querySelectorAll('.week-btn').forEach(b => b.classList.remove('active'));
            document.querySelector(`.week-btn[data-week="${week}"]`).classList.add('active');
            updateWeekView();
        }

        function updateWeekView() {
            const today = new Date();
            const weekStart = new Date(startDate);
            weekStart.setDate(startDate.getDate() + (currentWeek - 1) * 7);
            
            updateWeeklyProgress();
            
            const daysGrid = document.getElementById('daysGrid');
            daysGrid.innerHTML = '';
            
            const dayNames = ['Ïùº', 'Ïõî', 'Ìôî', 'Ïàò', 'Î™©', 'Í∏à', 'ÌÜ†'];
            
            for (let i = 0; i < 7; i++) {
            const currentDate = new Date(weekStart);
            currentDate.setDate(weekStart.getDate() + i);
            
            const dayCard = document.createElement('div');
            dayCard.className = 'day-card';
            if (currentDate.toDateString() === today.toDateString()) dayCard.classList.add('today');
            if (i === 0 || i === 6) dayCard.classList.add('weekend');
            
            const dayHeader = document.createElement('div');
            dayHeader.className = 'day-header';
            dayHeader.textContent = `${dayNames[i]} (${currentDate.getMonth() + 1}/${currentDate.getDate()})`;
            dayCard.appendChild(dayHeader);
            
            if (i === 0 || i === 6) {
                const placeholder = document.createElement('div');
                placeholder.className = 'weekend-placeholder';
                placeholder.innerHTML = i === 0 
                ? 'ÌïòÍ≥† Ïã∂ÏùÄ Ïùº ÎØ∏Î¶¨ÌïòÍ∏∞<br><br>ÏïΩÎ®πÍ∏∞<br>ÏûäÏßÄ ÏïäÍ∏∞'
                : 'Î™ªÌïú Ïùº<br>ÏôÑÎ£åÌïòÍ∏∞<br><br>ÏïΩÎ®πÍ∏∞<br>ÏûäÏßÄ ÏïäÍ∏∞';
                dayCard.appendChild(placeholder);
            } else {
                let completedCount = 0;
                tasks.forEach((task, index) => {
                const taskId = `${currentWeek}-${i}_task${index}`;
                const taskData = taskProgress[taskId] || {};
                const isCompleted = taskData.completed || false;
                if (isCompleted) completedCount++;
                
                const taskItem = document.createElement('div');
                taskItem.className = `task-item ${isCompleted ? 'completed' : ''}`;
                taskItem.onclick = () => toggleTask(taskId, taskItem);
                
                taskItem.innerHTML = `
                    <span class="task-name">${task.name}</span>
                    <span class="task-time">${taskData.time || ''}</span>
                `;
                dayCard.appendChild(taskItem);
                });
                
                const counter = document.createElement('div');
                counter.className = 'completion-counter';
                counter.textContent = `${completedCount}/${tasks.length}`;
                dayCard.appendChild(counter);
            }
            daysGrid.appendChild(dayCard);
            }
        }

        function updateWeeklyProgress() {
            const totalTasks = tasks.length * 5;
            let completedTasks = 0;
            
            for (let day = 1; day <= 5; day++) {
            tasks.forEach((task, index) => {
                const taskId = `${currentWeek}-${day}_task${index}`;
                if (taskProgress[taskId]?.completed) completedTasks++;
            });
            }
            
            const progressPercent = totalTasks > 0 ? Math.round((completedTasks / totalTasks) * 100) : 0;
            document.getElementById('weeklyProgress').textContent = 
            `${currentWeek}Ï£ºÏ∞® ÏßÑÌñâÎ•†: ${progressPercent}% (${completedTasks}/${totalTasks} ÏôÑÎ£å)`;
        }

        async function toggleTask(taskId, element) {
            const now = new Date();
            const timeString = `${String(now.getHours()).padStart(2,'0')}:${String(now.getMinutes()).padStart(2,'0')}`;
            
            if (element.classList.contains('completed')) {
            element.classList.remove('completed');
            await saveTaskProgress(taskId, { 
                completed: firebase.firestore.FieldValue.delete(), 
                time: firebase.firestore.FieldValue.delete() 
            });
            element.querySelector('.task-time').textContent = '';
            } else {
            element.classList.add('completed');
            await saveTaskProgress(taskId, { completed: true, time: timeString });
            element.querySelector('.task-time').textContent = timeString;
            }
            
            const dayCard = element.parentElement;
            const counter = dayCard.querySelector('.completion-counter');
            if (counter) {
            const completedItems = dayCard.querySelectorAll('.task-item.completed').length;
            const totalItems = dayCard.querySelectorAll('.task-item').length;
            counter.textContent = `${completedItems}/${totalItems}`;
            }
            updateWeeklyProgress();
        }

        // === Ïò§Î•∏Ï™Ω ÏùºÏùº Task / Ïö¥Îèô / Ï∑®ÎØ∏ Í¥ÄÎ†®  ===
        function selectExercise(type) {
            currentExercise = type;
            document.querySelectorAll('.exercise-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(`${type}Btn`).classList.add('active');
            updateExerciseView();
        }

        function updateExerciseView() {
            const today = new Date();
            const dayOfWeek = today.getDay();
            if (currentExercise === 'swimming') updateSwimmingView();
            else updateGolfView(dayOfWeek);
        }

        function updateSwimmingView() {
            document.getElementById('routineInfo').textContent = 'Ïù¥Î£®Í≥† Ïã∂ÏùÄ ÏùºÎì§ÏùÑ ÏûäÏßÄ ÎßêÏûê!';
            const routineGroups = document.getElementById('routineGroups');
            routineGroups.innerHTML = `
            <div class="routine-group warmup"><h4>Task 1</h4><ul class="routine-list" id="warmupList"></ul></div>
            <div class="routine-group main"><h4>Task 2</h4><ul class="routine-list" id="mainList"></ul></div>
            <div class="routine-group cooldown"><h4>Task 3</h4><ul class="routine-list" id="cooldownList"></ul></div>
            `;

            const todayRoutine = {
            warmup: getRandomExercises(swimmingDatabase.warmup, 1),
            main: getRandomExercises(swimmingDatabase.main, 3),
            cooldown: getRandomExercises(swimmingDatabase.cooldown, 1)
            };

            const todayKey = new Date().toLocaleDateString() + '_swimming';
            const savedProgress = exerciseProgress[todayKey] || {};

            let exerciseIndex = 0;
            Object.keys(todayRoutine).forEach(category => {
            const list = document.getElementById(`${category}List`);
            todayRoutine[category].forEach(ex => {
                const isCompleted = savedProgress[exerciseIndex] || false;
                const li = document.createElement('li');
                li.className = `exercise-item ${category} ${isCompleted ? 'completed' : ''}`;
                li.innerHTML = `<div class="exercise-name">${ex.emoji} ${ex.name} <font class="exercise-duration">${ex.duration}</font></div>`;
                li.onclick = () => openLinkAndToggle(ex.link, todayKey, exerciseIndex, li);
                list.appendChild(li);
                exerciseIndex++;
            });
            });
        }

        function updateGolfView(dayOfWeek) {
            const todayRoutine = golfDatabase.find(r => 
            Array.isArray(r.weekDay) ? r.weekDay.includes(dayOfWeek) : r.weekDay === dayOfWeek
            ) || { name: "Ìú¥ÏãùÏùº", items: [{ name: "Í∞ÄÎ≤ºÏö¥ ÏÇ∞Ï±Ö", reps: "20-40Î∂Ñ", type: "flexibility" }] };

            document.getElementById('routineInfo').textContent = `${todayRoutine.name} - ÏßëÏ§ë! Í∞êÎüâ, Í∑ºÎ†• Ìñ•ÏÉÅ`;
            const routineGroups = document.getElementById('routineGroups');
            routineGroups.innerHTML = `
            <div class="routine-group strength"><h4>Í∑ºÎ†• Í∞ïÌôî</h4><ul class="routine-list" id="strengthList"></ul></div>
            <div class="routine-group flexibility"><h4>Ïú†Ïó∞ÏÑ± Ïö¥Îèô</h4><ul class="routine-list" id="flexibilityList"></ul></div>
            <div class="routine-group golf-basic"><h4>Í≥®ÌîÑ Í∏∞Ï¥à</h4><ul class="routine-list" id="golfBasicList"></ul></div>
            `;

            const todayKey = new Date().toLocaleDateString() + '_golf';
            const savedProgress = exerciseProgress[todayKey] || {};

            const strength = getRandomExercises(todayRoutine.items.filter(i => i.type === 'strength'), 2);
            const flexibility = getRandomExercises(todayRoutine.items.filter(i => i.type === 'flexibility'), 2);
            const golfBasic = getRandomExercises(todayRoutine.items.filter(i => i.type === 'golf-basic'), 2);
            const all = [...strength, ...flexibility, ...golfBasic];

            let idx = 0;
            all.forEach(ex => {
            const isCompleted = savedProgress[idx] || false;
            const li = document.createElement('li');
            li.className = `exercise-item ${ex.type} ${isCompleted ? 'completed' : ''}`;
            li.innerHTML = `<div class="exercise-name">${ex.name} <font class="exercise-duration">${ex.reps}</font></div>`;
            li.onclick = () => openLinkAndToggle(ex.link, todayKey, idx, li);
            document.getElementById(
                ex.type === 'strength' ? 'strengthList' :
                ex.type === 'flexibility' ? 'flexibilityList' : 'golfBasicList'
            ).appendChild(li);
            idx++;
            });
        }

        function getRandomExercises(arr, n) {
            const shuffled = [...arr].sort(() => 0.5 - Math.random());
            return shuffled.slice(0, n);
        }

        async function openLinkAndToggle(link, dateKey, index, element) {
            if (link) window.open(link, '_blank');
            await toggleExercise(dateKey, index, element);
        }

        async function toggleExercise(dateKey, index, element) {
            const completed = !element.classList.contains('completed');
            element.classList.toggle('completed', completed);
            await saveExerciseProgress(dateKey, index, completed);
        }

        function updateDateInfo() {
            const today = new Date();
            const options = { year: 'numeric', month: 'long', day: 'numeric', weekday: 'long' };
            document.getElementById('dateInfo').textContent = today.toLocaleDateString('ko-KR', options);
        }

        function selectTodayExercise() {
            const day = new Date().getDay();
            selectExercise([1,3,5,0].includes(day) ? 'swimming' : 'golf');
        }

        function clearAllData() {
            taskProgress = {};
            exerciseProgress = {};
            updateWeekView();
            updateExerciseView();
        }

        function init() {
            updateDateInfo();
            createWeekSelector();
            selectTodayExercise();
        }

        window.addEventListener('DOMContentLoaded', init);    
    </script>
</body>
</html>
